<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Embassy STM32 HAL"><title>embassy_stm32 - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="embassy_stm32" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0-nightly (1ba35e9bb 2024-05-25)" data-channel="nightly" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../embassy_stm32/index.html">embassy_stm32</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#reexports">Re-exports</a></li><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li><li><a href="#structs">Structs</a></li><li><a href="#constants">Constants</a></li><li><a href="#traits">Traits</a></li><li><a href="#functions">Functions</a></li><li><a href="#attributes">Attribute Macros</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">embassy_stm32</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/embassy_stm32/lib.rs.html#1-289">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="embassy-stm32-hal"><a class="doc-anchor" href="#embassy-stm32-hal">§</a>Embassy STM32 HAL</h2>
<p>The embassy-stm32 HAL aims to provide a safe, idiomatic hardware abstraction layer for all STM32 families. The HAL implements both blocking and async APIs for many peripherals. Where appropriate, traits from both blocking and asynchronous versions of <a href="https://docs.rs/embedded-hal/latest/embedded_hal/">embedded-hal</a> v0.2 and v1.0 are implemented, as well as serial traits from embedded-io[-async].</p>
<ul>
<li><a href="https://crates.io/crates/embassy-stm32">embassy-stm32 on crates.io</a></li>
<li><a href="https://docs.embassy.dev/embassy-stm32/">Documentation</a> (<strong>Important:</strong> use docs.embassy.dev rather than docs.rs to see the specific docs for the chip you’re using!)</li>
<li><a href="https://github.com/embassy-rs/embassy/tree/main/embassy-stm32">Source</a></li>
<li><a href="https://github.com/embassy-rs/embassy/tree/main/examples">Examples</a></li>
</ul>
<h3 id="embassy-stm32-supports-all-stm32-chip-families"><a class="doc-anchor" href="#embassy-stm32-supports-all-stm32-chip-families">§</a>embassy-stm32 supports all STM32 chip families</h3>
<p>STM32 microcontrollers come in many families and flavors, and supporting all of them is a big undertaking. Embassy takes advantage of the fact that the STM32 peripheral versions are shared across chip families. For example, instead of re-implementing the SPI peripheral for every STM32 chip family, embassy has a single SPI implementation that depends on code-generated register types that are identical for STM32 families with the same version of a given peripheral.</p>
<p>In practice, this works as follows:</p>
<ol>
<li>You tell the compiler which chip you’re using with a feature flag</li>
<li>The stm32-metapac module generates register types for that chip at compile time, based on data from the stm32-data module</li>
<li>The embassy-stm32 HAL picks the correct implementation each peripheral based on automatically-generated feature flags, and applies any other tweaks which are required for the HAL to work on that chip</li>
</ol>
<p>Be aware that, while embassy-stm32 strives to consistently support all peripherals across all chips, this approach can lead to slightly different APIs and capabilities being available on different families. Check the <a href="https://docs.embassy.dev/embassy-stm32/">documentation</a> for the specific chip you’re using to confirm exactly what’s available.</p>
<h3 id="embedded-hal"><a class="doc-anchor" href="#embedded-hal">§</a>Embedded-hal</h3>
<p>The <code>embassy-stm32</code> HAL implements the traits from <a href="https://crates.io/crates/embedded-hal">embedded-hal</a> (v0.2 and 1.0) and <a href="https://crates.io/crates/embedded-hal-async">embedded-hal-async</a>, as well as <a href="https://crates.io/crates/embedded-io">embedded-io</a> and <a href="https://crates.io/crates/embedded-io-async">embedded-io-async</a>.</p>
<h3 id="embassy-time-time-driver"><a class="doc-anchor" href="#embassy-time-time-driver">§</a><code>embassy-time</code> time driver</h3>
<p>If a <code>time-driver-*</code> feature is enabled, embassy-stm32 provides a time driver for use with <a href="https://docs.embassy.dev/embassy-time/">embassy-time</a>. You can pick which hardware timer is used for this internally via the <code>time-driver-tim*</code> features, or let embassy pick with <code>time-driver-any</code>.</p>
<p>embassy-time has a default tick rate of 1MHz, which is fast enough to cause problems with the 16-bit timers currently supported by the embassy-stm32 time driver (specifically, if a critical section delays an IRQ by more than 32ms). To avoid this, it’s recommended to pick a lower tick rate. 32.768kHz is a reasonable default for many purposes.</p>
<h3 id="interoperability"><a class="doc-anchor" href="#interoperability">§</a>Interoperability</h3>
<p>This crate can run on any executor.</p>
<p>Optionally, some features requiring <a href="https://crates.io/crates/embassy-time"><code>embassy-time</code></a> can be activated with the <code>time</code> feature. If you enable it,
you must link an <code>embassy-time</code> driver in your project.</p>
<p>The <code>low-power</code> feature integrates specifically with <code>embassy-executor</code>, it can’t be ued on other executors for now.</p>
<h3 id="feature-flags"><a class="doc-anchor" href="#feature-flags">§</a>Feature flags</h3>
<ul>
<li><span class="stab portability"><code>rt</code></span> <em>(enabled by default)</em> —  Enable <code>stm32-metapac</code>’s <code>rt</code> feature</li>
<li><span class="stab portability"><code>defmt</code></span> —  Use <a href="https://docs.rs/defmt/latest/defmt/"><code>defmt</code></a> for logging</li>
<li><span class="stab portability"><code>memory-x</code></span> —  Automatically generate <code>memory.x</code> file using <a href="https://docs.rs/stm32-metapac/"><code>stm32-metapac</code></a></li>
<li><span class="stab portability"><code>unstable-pac</code></span> —  Re-export stm32-metapac at <code>embassy_stm32::pac</code>.
This is unstable because semver-minor (non-breaking) releases of embassy-stm32 may major-bump (breaking) the stm32-metapac version.
If this is an issue for you, you’re encouraged to directly depend on a fixed version of the PAC.
There are no plans to make this stable.</li>
</ul>
<h3 id="time"><a class="doc-anchor" href="#time">§</a>Time</h3>
<ul>
<li><span class="stab portability"><code>time</code></span> —  Enables additional driver features that depend on embassy-time</li>
<li><span class="stab portability"><code>time-driver-any</code></span> —  Use any time driver</li>
<li><span class="stab portability"><code>time-driver-tim2</code></span> —  Use TIM2 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim3</code></span> —  Use TIM3 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim4</code></span> —  Use TIM4 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim5</code></span> —  Use TIM5 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim9</code></span> —  Use TIM9 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim11</code></span> —  Use TIM11 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim12</code></span> —  Use TIM12 as time driver</li>
<li><span class="stab portability"><code>time-driver-tim15</code></span> —  Use TIM15 as time driver</li>
</ul>
<h3 id="analog-switch-pins-pxy_c-on-stm32h7-series"><a class="doc-anchor" href="#analog-switch-pins-pxy_c-on-stm32h7-series">§</a>Analog Switch Pins (Pxy_C) on STM32H7 series</h3>
<p>Get <code>PXY</code> and <code>PXY_C</code> singletons. Digital impls are on <code>PXY</code>, Analog impls are on <code>PXY_C</code>
If disabled, you get only the <code>PXY</code> singleton. It has both digital and analog impls.</p>
<ul>
<li><span class="stab portability"><code>split-pa0</code></span> —  Split PA0</li>
<li><span class="stab portability"><code>split-pa1</code></span> —  Split PA1</li>
<li><span class="stab portability"><code>split-pc2</code></span> —  Split PC2</li>
<li><span class="stab portability"><code>split-pc3</code></span> —  Split PC3</li>
<li><span class="stab portability"><code>_split-pins-enabled</code></span> —  internal use only</li>
</ul>
<h3 id="chip-selection-features"><a class="doc-anchor" href="#chip-selection-features">§</a>Chip-selection features</h3>
<p>Select your chip by specifying the model as a feature, e.g. <code>stm32c011d6</code>.
Check the <code>Cargo.toml</code> for the latest list of supported chips.</p>
<p><strong>Important:</strong> Do not forget to adapt the target chip in your toolchain,
e.g. in <code>.cargo/config.toml</code>.</p>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.pac"><code>pub use stm32_metapac as pac;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="adc/index.html" title="mod embassy_stm32::adc">adc</a></div><div class="desc docblock-short">Analog to Digital Converter (ADC)</div></li><li><div class="item-name"><a class="mod" href="can/index.html" title="mod embassy_stm32::can">can</a></div><div class="desc docblock-short">Controller Area Network (CAN)</div></li><li><div class="item-name"><a class="mod" href="crc/index.html" title="mod embassy_stm32::crc">crc</a></div><div class="desc docblock-short">Cyclic Redundancy Check (CRC)</div></li><li><div class="item-name"><a class="mod" href="dac/index.html" title="mod embassy_stm32::dac">dac</a></div><div class="desc docblock-short">Digital to Analog Converter (DAC)</div></li><li><div class="item-name"><a class="mod" href="dcmi/index.html" title="mod embassy_stm32::dcmi">dcmi</a></div><div class="desc docblock-short">Digital Camera Interface (DCMI)</div></li><li><div class="item-name"><a class="mod" href="dma/index.html" title="mod embassy_stm32::dma">dma</a></div><div class="desc docblock-short">Direct Memory Access (DMA)</div></li><li><div class="item-name"><a class="mod" href="exti/index.html" title="mod embassy_stm32::exti">exti</a></div><div class="desc docblock-short">External Interrupts (EXTI)</div></li><li><div class="item-name"><a class="mod" href="flash/index.html" title="mod embassy_stm32::flash">flash</a></div><div class="desc docblock-short">Flash memory (FLASH)</div></li><li><div class="item-name"><a class="mod" href="fmc/index.html" title="mod embassy_stm32::fmc">fmc</a></div><div class="desc docblock-short">Flexible Memory Controller (FMC) / Flexible Static Memory Controller (FSMC)</div></li><li><div class="item-name"><a class="mod" href="gpio/index.html" title="mod embassy_stm32::gpio">gpio</a></div><div class="desc docblock-short">General-purpose Input/Output (GPIO)</div></li><li><div class="item-name"><a class="mod" href="i2c/index.html" title="mod embassy_stm32::i2c">i2c</a></div><div class="desc docblock-short">Inter-Integrated-Circuit (I2C)</div></li><li><div class="item-name"><a class="mod" href="interrupt/index.html" title="mod embassy_stm32::interrupt">interrupt</a></div><div class="desc docblock-short">Interrupt definitions.</div></li><li><div class="item-name"><a class="mod" href="peripherals/index.html" title="mod embassy_stm32::peripherals">peripherals</a></div><div class="desc docblock-short">Types for the peripheral singletons.</div></li><li><div class="item-name"><a class="mod" href="rcc/index.html" title="mod embassy_stm32::rcc">rcc</a></div><div class="desc docblock-short">Reset and Clock Control (RCC)</div></li><li><div class="item-name"><a class="mod" href="rng/index.html" title="mod embassy_stm32::rng">rng</a></div><div class="desc docblock-short">Random Number Generator (RNG)</div></li><li><div class="item-name"><a class="mod" href="rtc/index.html" title="mod embassy_stm32::rtc">rtc</a></div><div class="desc docblock-short">Real Time Clock (RTC)</div></li><li><div class="item-name"><a class="mod" href="sai/index.html" title="mod embassy_stm32::sai">sai</a></div><div class="desc docblock-short">Serial Audio Interface (SAI)</div></li><li><div class="item-name"><a class="mod" href="sdmmc/index.html" title="mod embassy_stm32::sdmmc">sdmmc</a></div><div class="desc docblock-short">Secure Digital / MultiMedia Card (SDMMC)</div></li><li><div class="item-name"><a class="mod" href="spi/index.html" title="mod embassy_stm32::spi">spi</a></div><div class="desc docblock-short">Serial Peripheral Interface (SPI)</div></li><li><div class="item-name"><a class="mod" href="time/index.html" title="mod embassy_stm32::time">time</a></div><div class="desc docblock-short">Time units</div></li><li><div class="item-name"><a class="mod" href="timer/index.html" title="mod embassy_stm32::timer">timer</a></div><div class="desc docblock-short">Timers, PWM, quadrature decoder.</div></li><li><div class="item-name"><a class="mod" href="uid/index.html" title="mod embassy_stm32::uid">uid</a></div><div class="desc docblock-short">Unique ID (UID)</div></li><li><div class="item-name"><a class="mod" href="usart/index.html" title="mod embassy_stm32::usart">usart</a></div><div class="desc docblock-short">Universal Synchronous/Asynchronous Receiver Transmitter (USART, UART, LPUART)</div></li><li><div class="item-name"><a class="mod" href="usb_otg/index.html" title="mod embassy_stm32::usb_otg">usb_otg</a></div><div class="desc docblock-short">USB On The Go (OTG)</div></li><li><div class="item-name"><a class="mod" href="wdg/index.html" title="mod embassy_stm32::wdg">wdg</a></div><div class="desc docblock-short">Watchdog Timer (IWDG, WWDG)</div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.bind_interrupts.html" title="macro embassy_stm32::bind_interrupts">bind_interrupts</a></div><div class="desc docblock-short">Macro to bind interrupts to handlers.</div></li><li><div class="item-name"><a class="macro" href="macro.into_ref.html" title="macro embassy_stm32::into_ref">into_ref</a></div><div class="desc docblock-short">Convenience converting into reference.</div></li></ul><h2 id="structs" class="section-header">Structs<a href="#structs" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="struct" href="struct.Config.html" title="struct embassy_stm32::Config">Config</a></div><div class="desc docblock-short"><code>embassy-stm32</code> global configuration.</div></li><li><div class="item-name"><a class="struct" href="struct.PeripheralRef.html" title="struct embassy_stm32::PeripheralRef">PeripheralRef</a></div><div class="desc docblock-short">An exclusive reference to a peripheral.</div></li><li><div class="item-name"><a class="struct" href="struct.Peripherals.html" title="struct embassy_stm32::Peripherals">Peripherals</a></div><div class="desc docblock-short">Struct containing all the peripheral singletons.</div></li></ul><h2 id="constants" class="section-header">Constants<a href="#constants" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="constant" href="constant.NVIC_PRIO_BITS.html" title="constant embassy_stm32::NVIC_PRIO_BITS">NVIC_PRIO_BITS</a></div><div class="desc docblock-short">Number available in the NVIC for configuring priority</div></li></ul><h2 id="traits" class="section-header">Traits<a href="#traits" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="trait" href="trait.Peripheral.html" title="trait embassy_stm32::Peripheral">Peripheral</a></div><div class="desc docblock-short">Trait for any type that can be used as a peripheral of type <code>P</code>.</div></li></ul><h2 id="functions" class="section-header">Functions<a href="#functions" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="fn" href="fn.init.html" title="fn embassy_stm32::init">init</a></div><div class="desc docblock-short">Initialize the <code>embassy-stm32</code> HAL with the provided configuration.</div></li></ul><h2 id="attributes" class="section-header">Attribute Macros<a href="#attributes" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="attr" href="attr.interrupt.html" title="attr embassy_stm32::interrupt">interrupt</a></div></li></ul></section></div></main></body></html>